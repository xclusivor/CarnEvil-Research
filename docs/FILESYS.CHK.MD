# FILESYS.CHK

Table containing CRC checksums of every file referenced by the game. Potentially more than that. 

If you modify a file on disk and attempt to start the game, it will fail the integrity check and fail to start the game. 

Each files metadata is in a size `0x126` chunk.
```
00000000: 4c 46 4e 33 32 00 2b 02 6f 7c 41 26 00 00 41 26  LFN32.+.o|A&..A&
00000010: 98 b9 04 00 3e 20 5d 5c 45 25 a4 66 01 00 48 48  ....> ]\E%.f..HH
00000020: 4f 55 2e 52 41 57 00 4e 4b 00 00 00 70 3e f7 c0  OU.RAW.NK...p>..
00000030: 02 30 00 00 02 30 00 00 c2 13 00 00 00 00 00 00  .0...0..........
00000040: 00 00 00 00 78 ba 04 00 fa 49 00 00 05 00 00 00  ....x....I......
00000050: 05 00 00 00 70 13 05 00 78 ba 04 00 4a 4a 00 00  ....p...x...JJ..
00000060: 66 49 00 00 65 00 00 00 60 e2 04 00 54 00 00 00  fI..e...`...T...
00000070: 90 ba 00 00 ce e2 04 00 49 00 00 00 f9 10 05 00  ........I.......
00000080: 4d 49 00 00 64 c0 04 00 00 00 00 00 00 00 00 00  MI..d...........
00000090: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
000000a0: f6 ab 04 00 25 3b 43 3a 7d a8 04 00 70 03 00 00  ....%;C:}...p...
000000b0: 00 00 00 00 70 13 05 00 00 10 05 00 5b 67 65 6e  ....p.......[gen
000000c0: 66 63 68 6b 5d 00 0d 30 63 34 30 30 30 0d 00 00  fchk]..0c4000...
000000d0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
000000e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
000000f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00000100: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00000110: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
00000120: 00 00 e1 bc 38 2b                                ....8+
```

I suspect `LFN32` refers to FAT32 Long Filenames.

Starting at the `0x1b`th byte is the files size on disk. Likely `uint32` wide. In this case the file size is `a4 66 01 00`.

Starting at the `0x123`rd byte is the files CRC hash. Likely `uint32` wide. In this case the checksum is `e1 bc 38 2b`.

## Bypassing the integrity check
As mentioned above, if you try to change any games assets that are listed in this file, the game will not start. When DIAG.EXE starts it will check the CRC in the table against the CRC of the corresponding file on disk. 

You can circumvent this check by simply recalculating the checksum. If I replace KRIKFACE.WMS with SMILFACE.WMS, I just need to replace SMILFACE.VMSs CRC with KRIKFACE.VMSs as well as replace the contents of the file on disk. 

Using this method you can create completely custom assets as long as you calculate CRC and replace it in the table. 